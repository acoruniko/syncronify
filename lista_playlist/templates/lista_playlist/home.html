{% extends "base.html" %}
{% load static %}

{% block title %}Lista de Playlist | Syncronify{% endblock %}

{% block content %}
<div class="importar-container">
  <h1>Lista de Playlist</h1>

  <div class="importar-content">
    <!-- Columna izquierda: lista -->
    <div class="playlist-list-vertical">
      {% for playlist in playlists %}
        <div class="playlist-row" onclick="selectPlaylist(this)" data-id="{{ playlist.id_playlist }}">
          {% if playlist.cover_url %}
            <img src="{{ playlist.cover_url }}" alt="Cover {{ playlist.nombre }}" class="playlist-cover">
          {% else %}
            <img src="{% static 'img/placeholder.png' %}" alt="Sin imagen" class="playlist-cover">
          {% endif %}
          <div class="playlist-info">
            <h3>{{ playlist.nombre }}</h3>
            <p>{{ playlist.total_canciones }} canciones · {{ playlist.propietario }}</p>
          </div>
        </div>
      {% empty %}
        <p>No hay playlists almacenadas.</p>
      {% endfor %}
    </div>
    
    <div class="action-panel">
  <!-- Bloque superior: acciones sobre playlist seleccionada -->
  <div class="action-buttons-vertical">
    <button id="btn-editar" class="action-btn" disabled>Editar</button>
    <button id="btn-eliminar" class="action-btn" disabled>Eliminar</button>
  </div>

  <!-- Bloque inferior: acciones generales -->
  <div class="action-buttons-vertical general-actions">
    <button id="btn-sincronizar" class="action-btn">Sincronizar con Spotify</button>
    <form action="{% url 'importar_playlists' %}" method="get">
      {% if rate_limited %}
        <button type="submit" class="action-btn primary" disabled>
          Importar playlists desde Spotify (bloqueado)
        </button>
      {% else %}
        <button type="submit" class="action-btn primary">
          Importar playlists desde Spotify
        </button>
      {% endif %}
    </form>
    <button id="btn-logs" class="action-btn">Logs de la aplicación</button>
  </div>
</div>

<script>
  let selectedPlaylistId = null;
  function selectPlaylist(el) {
    document.querySelectorAll('.playlist-row').forEach(p => p.classList.remove('selected'));
    el.classList.add('selected');
    selectedPlaylistId = el.dataset.id;
    document.getElementById('btn-editar').disabled = false;
    document.getElementById('btn-eliminar').disabled = false;
  }
</script>
{% endblock %}